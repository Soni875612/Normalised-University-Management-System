{% extends "base.html" %}
{% block title %}{{ student.first_name }} {{ student.last_name }} - UMS{% endblock %}
{% block page_title %}Student Profile{% endblock %}
{% block content %}
<div class="row g-3">
    <!-- Profile Card -->
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body py-4">
                <div class="d-inline-flex align-items-center justify-content-center rounded-circle mb-3"
                     style="width:80px;height:80px;background:linear-gradient(135deg,#1a237e,#42a5f5);">
                    <span class="text-white fw-bold fs-3">{{ student.first_name[0] }}{{ student.last_name[0] }}</span>
                </div>
                <h5 class="fw-bold mb-0">{{ student.first_name }} {{ student.last_name }}</h5>
                <p class="text-muted small">{{ student.enrollment_no }}</p>
                <span class="badge {% if student.status=='Active' %}bg-success{% else %}bg-secondary{% endif %} mb-3">
                    {{ student.status }}
                </span>
                <hr>
                <div class="text-start">
                    <p class="small mb-2"><i class="fas fa-building me-2 text-primary"></i>{{ student.dept_name }}</p>
                    <p class="small mb-2"><i class="fas fa-layer-group me-2 text-primary"></i>Semester {{ student.semester }}</p>
                    <p class="small mb-2"><i class="fas fa-envelope me-2 text-primary"></i>{{ student.email }}</p>
                    {% if student.phone %}
                    <p class="small mb-2"><i class="fas fa-phone me-2 text-primary"></i>{{ student.phone }}</p>
                    {% endif %}
                    {% if student.city %}
                    <p class="small mb-2"><i class="fas fa-map-marker-alt me-2 text-primary"></i>{{ student.city }}, {{ student.state }}</p>
                    {% endif %}
                    {% if student.dob %}
                    <p class="small mb-2"><i class="fas fa-birthday-cake me-2 text-primary"></i>{{ student.dob }}</p>
                    {% endif %}
                    <p class="small mb-0"><i class="fas fa-calendar me-2 text-primary"></i>Admitted: {{ student.admission_year }}</p>
                </div>
            </div>
        </div>

        <!-- CGPA Card -->
        <div class="card mt-3 text-center">
            <div class="card-body py-3">
                <p class="text-muted small mb-1">Overall CGPA</p>
                <h2 class="fw-bold {% if cgpa >= 8 %}text-success{% elif cgpa >= 6 %}text-primary{% elif cgpa >= 5 %}text-warning{% else %}text-danger{% endif %}">
                    {{ cgpa if cgpa > 0 else 'N/A' }}
                </h2>
                <small class="text-muted">Out of 10.0</small>
            </div>
        </div>
    </div>

    <!-- Enrollments & Grades -->
    <div class="col-md-8">
        <div class="card">
            <div class="card-header py-3">
                <i class="fas fa-clipboard-list me-2 text-primary"></i>Enrolled Courses & Grades
            </div>
            <div class="card-body p-0">
                <table class="table table-hover mb-0">
                    <thead>
                        <tr>
                            <th>Course</th>
                            <th>Code</th>
                            <th>Credits</th>
                            <th>Year</th>
                            <th>Marks</th>
                            <th>Grade</th>
                            <th>GP</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for e in enrollments %}
                        <tr>
                            <td class="fw-medium small">{{ e.course_name }}</td>
                            <td><code class="small">{{ e.course_code }}</code></td>
                            <td>{{ e.credits }}</td>
                            <td class="text-muted small">{{ e.academic_year }}</td>
                            <td>{{ e.marks_obtained if e.marks_obtained is not none else '-' }}</td>
                            <td>
                                {% if e.grade %}
                                <span class="badge {% if e.grade in ['O','A+','A'] %}bg-success{% elif e.grade in ['B+','B'] %}bg-primary{% elif e.grade == 'C' %}bg-warning text-dark{% else %}bg-danger{% endif %}">
                                    {{ e.grade }}
                                </span>
                                {% else %}-{% endif %}
                            </td>
                            <td>{{ e.grade_point if e.grade_point is not none else '-' }}</td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="7" class="text-center text-muted py-4">No enrollments found</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="mt-3">
    <a href="{{ url_for('students') }}" class="btn btn-outline-secondary btn-sm">
        <i class="fas fa-arrow-left me-1"></i>Back to Students
    </a>
</div>
{% endblock %}